<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn European Portuguese - Free Interactive Course</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%231f2937'/%3E%3Ccircle cx='32' cy='32' r='26' fill='%23667eea'/%3E%3Ctext x='50%25' y='58%25' font-size='28' text-anchor='middle' fill='white' font-family='Arial, sans-serif' font-weight='700'%3EPT%3C/text%3E%3C/svg%3E">
    <!-- Modular CSS components -->
    <link rel="stylesheet" href="src/styles/variables.css">
    <link rel="stylesheet" href="src/styles/reset.css">
    <link rel="stylesheet" href="src/styles/buttons.css">
    <link rel="stylesheet" href="src/styles/cards.css">
    <link rel="stylesheet" href="src/styles/lessons.css">
    <link rel="stylesheet" href="src/styles/navigation.css">
    <link rel="stylesheet" href="src/styles/modals.css">
    <link rel="stylesheet" href="src/styles/toast.css">
    <link rel="stylesheet" href="src/styles/animations.css">
    <link rel="stylesheet" href="src/styles/accordion.css">
    <!-- Main styles (can override modular components) -->
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Top Header Bar -->
    <header class="top-header">
        <button class="logo-btn" id="logoBtn" aria-label="PortuLingo Home">ğŸ‡µğŸ‡¹</button>
        <div class="header-stats">
            <div class="hearts-display" id="heartsDisplay">
                <span class="heart-icon">â¤ï¸</span>
                <span class="hearts-count" id="heartsCount">5</span>
                <span class="hearts-timer" id="heartsTimer"></span>
            </div>
            <div class="streak-badge" id="streakBadge">
                <span class="streak-icon">ğŸ”¥</span>
                <span class="streak-count" id="streakCount">0</span>
            </div>
            <div class="xp-badge" id="xpBadge">
                <span class="xp-icon">â­</span>
                <span class="xp-count" id="xpCount">0</span>
            </div>
        </div>
        <div class="header-actions">
            <button class="btn-theme" id="themeToggle" aria-label="Toggle theme">ğŸŒ™</button>
            <button class="btn-premium" id="premiumBtn">ğŸ‘‘</button>
        </div>
    </header>

    <!-- Main Content Area with Pages -->
    <main class="main-content">
        <!-- Home Page -->
        <div class="page active" id="page-home" data-page="home">

    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Master European Portuguese</h1>
            <p>Learn word by word with interactive lessons and engaging practice</p>
            <button class="btn-start" id="startBtn">Start Learning Free</button>
        </div>
        <div class="hero-visual">
            <div class="hero-photo tram" aria-hidden="true">
                <span class="photo-label">Lisboa</span>
            </div>
            <div class="hero-photo coast" aria-hidden="true">
                <span class="photo-label">Costa</span>
            </div>
            <div class="hero-stack">
                <div class="stack-card">Pastel de nata</div>
                <div class="stack-card">Tram 28</div>
                <div class="stack-card">Fado nights</div>
            </div>
            <div class="hero-badge" aria-label="European Portuguese only">EUâ€‘PT only</div>
        </div>
        </section>
        </div>

        <!-- Learn Page -->
        <div class="page" id="page-learn" data-page="learn">
        <section id="learn" class="learning-section">
        <div class="learning-header">
            <div>
                <h2>Begin Your Journey</h2>
                <p class="muted">Pick a topic and start listening.</p>
            </div>
            <div class="speaker-toggle">
                <label><input type="radio" name="speakerGender" value="male" checked> Male form</label>
                <label><input type="radio" name="speakerGender" value="female"> Female form</label>
            </div>
        </div>
        <div class="topics-bar" id="topicFilters"></div>
        <div class="mood-strip" aria-hidden="true">
            <div class="mood-card">â˜• CafÃ©</div>
            <div class="mood-card">ğŸš‹ ElÃ©trico</div>
            <div class="mood-card">ğŸŒŠ AtlÃ¢ntico</div>
            <div class="mood-card">ğŸ—ºï¸ Viagem</div>
        </div>
        <div class="lesson-grid" id="lessonGrid">
            <!-- Lessons will be dynamically loaded -->
        </div>
        </section>
        </div>

        <!-- Practice Page (Vault, Flashcards, Dialogues, Coach) -->
        <div class="page" id="page-practice" data-page="practice">
        <section id="vault" class="vault-section">
        <h2>ğŸ“š My Learned Words Vault</h2>
        <div class="vault-stats">
            <div class="stat-card">
                <span class="stat-number" id="totalWords">0</span>
                <span class="stat-label">Words Learned</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="streak">0</span>
                <span class="stat-label">Day Streak</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="notepadCount">0</span>
                <span class="stat-label">Saved Notes</span>
            </div>
        </div>
        <div class="vault-actions">
            <div class="review-card">
                <div class="review-header">
                    <button class="btn-review" id="reviewBtn">Quick Review Quiz</button>
                    <button class="btn-review" id="listeningDrillBtn">ğŸ§ Listening Drill</button>
                    <button class="btn-review" id="interleavedReviewBtn">ğŸ”€ Interleaved Review</button>
                    <span class="muted">Multiple modes powered by your SRS buckets.</span>
                </div>
                <div class="review-modes">
                    <label class="mode-toggle"><input type="checkbox" id="audioOnlyMode"> Audio Only (no text)</label>
                    <label class="mode-toggle"><input type="checkbox" id="timedMode"> â±ï¸ Timed Challenge</label>
                    <select id="speedControl" class="speed-select">
                        <option value="0.5">0.5x Speed</option>
                        <option value="0.75">0.75x Speed</option>
                        <option value="1" selected>1x Speed</option>
                        <option value="1.25">1.25x Speed</option>
                        <option value="1.5">1.5x Speed</option>
                        <option value="2">2x Speed</option>
                    </select>
                </div>
                <div id="reviewPrompt" class="review-prompt">Tap start to generate a quick question.</div>
                <div id="timerDisplay" class="timer-display" style="display:none;">Time: <span id="timerValue">0</span>s</div>
                <div id="reviewOptions" class="review-options"></div>
                <div id="reviewResult" class="review-result"></div>
            </div>
            <div class="srs-panel">
                <p class="muted">SRS Buckets</p>
                <div id="srsBuckets" class="srs-buckets"></div>
                <div class="vault-stats">
                    <button class="btn-secondary" id="viewAnalyticsBtn">ğŸ“Š View Progress Analytics</button>
                    <button class="btn-secondary" id="exportDataBtn">ğŸ’¾ Export Data</button>
                    <button class="btn-secondary" id="importDataBtn">ğŸ“¥ Import Data</button>
                </div>
            </div>
        </div>
        
        <!-- Translator Section -->
        <div class="translator-section">
            <h3>ğŸ”„ Sentence Translator</h3>
            <p class="muted">Type in English and get EU-Portuguese translation with grammar notes.</p>
            <div class="translator-input-area">
                <textarea id="translatorInput" placeholder="Type a sentence in English..." rows="2"></textarea>
                <div class="translator-actions">
                    <button class="btn-small" id="translateBtn">ğŸ”„ Translate to PT</button>
                </div>
                <div id="translatorOutput" class="translator-output" style="display:none;">
                    <div class="pt-text" id="translationPt"></div>
                    <div class="translator-actions">
                        <button class="btn-small" id="speakTranslationBtn">ğŸ”Š Listen</button>
                        <button class="btn-small" id="saveTranslationBtn">ğŸ“Œ Save to Notepad</button>
                    </div>
                    <div class="translation-notes" id="translationNotes"></div>
                </div>
            </div>
        </div>
        
        <!-- Personal Notepad Section -->
        <div class="notepad-section">
            <h3>ğŸ“ Personal Notepad</h3>
            <p class="muted">Save words and phrases for later study.</p>
            <div class="notepad-add-form">
                <div class="form-group">
                    <label for="notepadPt">Portuguese</label>
                    <input type="text" id="notepadPt" placeholder="Word or phrase">
                </div>
                <div class="form-group">
                    <label for="notepadEn">English</label>
                    <input type="text" id="notepadEn" placeholder="Meaning">
                </div>
                <div class="form-group">
                    <label for="notepadNote">Note</label>
                    <input type="text" id="notepadNote" placeholder="Personal note (optional)">
                </div>
                <button class="btn-add-note" id="addNoteBtn">+ Add</button>
            </div>
            <div id="notepadList" class="notepad-list">
                <!-- Notepad items will appear here -->
            </div>
        </div>
        
        <div class="vault-filters">
            <input type="text" id="vaultSearch" placeholder="Search Portuguese or English" aria-label="Search learned words">
            <div class="vault-sort-group">
                <button class="btn-sort active" id="vaultSortPt">Sort by Portuguese</button>
                <button class="btn-sort" id="vaultSortEn">Sort by English</button>
            </div>
            <button class="btn-clear" id="vaultClearFilters">Clear Filters</button>
        </div>
        <div class="word-list" id="wordList">
            <!-- Learned words will appear here -->
        </div>
    </section>

    <!-- Flashcards Section -->
    <section id="flashcards" class="flashcards-section">
        <div class="flashcards-header">
            <h2>ğŸƒ Flashcards</h2>
            <p class="muted">Master your vocabulary with smart repetition and memory techniques</p>
        </div>
        
        <div class="flashcards-controls">
            <div class="flashcards-stats-row">
                <div class="stat-card">
                    <span class="stat-number" id="flashcardsCount">0</span>
                    <span class="stat-label">Cards Saved</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="flashcardsGroupCount">0</span>
                    <span class="stat-label">Groups</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="flashcardsDueCount">0</span>
                    <span class="stat-label">Due for Review</span>
                </div>
            </div>
            
            <div class="flashcards-action-row">
                <div class="add-chapter-card">
                    <h3>ğŸ“š Add Entire Lesson</h3>
                    <p class="muted">Save all words and sentences from a lesson at once</p>
                    <div class="chapter-add-form">
                        <select id="chapterSelector" class="chapter-select">
                            <option value="">-- Select a lesson --</option>
                        </select>
                        <select id="targetGroupSelector" class="chapter-select">
                            <option value="">ğŸ“ Default Group</option>
                        </select>
                        <button class="btn-add-chapter" id="saveChapterBtn">â• Add to Flashcards</button>
                    </div>
                </div>
                
                <div class="group-manager-card">
                    <h3>ğŸ“ Manage Groups</h3>
                    <p class="muted">Organize flashcards into custom groups</p>
                    <div class="group-create-form">
                        <input type="text" id="newGroupName" placeholder="New group name..." class="group-input">
                        <button class="btn-create-group" id="createGroupBtn">â• Create Group</button>
                    </div>
                    <div id="groupsList" class="groups-list">
                        <!-- Groups will appear here -->
                    </div>
                </div>
            </div>
            
            <div class="flashcards-review-row">
                <div class="review-mode-card">
                    <h3>ğŸ”„ Review Mode</h3>
                    <p class="muted">Spaced repetition for optimal learning</p>
                    <div class="review-options">
                        <select id="reviewGroupFilter" class="review-filter">
                            <option value="all">All Cards</option>
                            <option value="due">Due Only</option>
                        </select>
                        <button class="btn-start-review" id="startReviewBtn">Start Review</button>
                    </div>
                    <div id="flashcardsReviewArea" class="review-area"></div>
                </div>
                
                <div class="export-card">
                    <h3>ğŸ“¤ Export Flashcards</h3>
                    <p class="muted">Export to Anki or other apps</p>
                    <div class="export-options">
                        <select id="exportGroupSelect" class="export-select">
                            <option value="all">All Groups</option>
                        </select>
                        <button class="btn-export" id="exportAnkiBtn">ğŸ“± Export for Anki</button>
                        <button class="btn-export-csv" id="exportCSVBtn">ğŸ“„ Export CSV</button>
                    </div>
                    <p class="export-hint">Import the .txt file into AnkiDroid or AnkiMobile</p>
                </div>
            </div>
        </div>
        
        <div class="flashcards-list-container">
            <div class="flashcards-list-header">
                <h3>ğŸ“‹ My Flashcards</h3>
                <div class="flashcards-filters">
                    <select id="flashcardsGroupFilter" class="filter-select">
                        <option value="all">All Groups</option>
                    </select>
                    <input type="text" id="flashcardsSearch" placeholder="Search cards..." class="search-input">
                </div>
            </div>
            <div id="flashcardsList" class="flashcards-list">
                <!-- Flashcards will appear here -->
            </div>
        </div>
        </section>

        </div>

        <!-- Profile Page (Dashboard, Tips, Plans) -->
        <div class="page" id="page-profile" data-page="profile">
        <section id="dashboard" class="dashboard-section">
        <h2>User Dashboard</h2>
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h3>Account Status</h3>
                <p id="accountStatus">Free Plan</p>
                <button class="btn-upgrade">Upgrade to Premium</button>
            </div>
            <div class="dashboard-card">
                <h3>Progress</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p id="progressText">0% Complete</p>
                <button class="btn-reset" id="resetProgressBtn">Reset Progress</button>
            </div>
            <div class="dashboard-card lesson-metrics">
                <h3>Lesson Insights</h3>
                <div class="metric-row">
                    <div class="metric-pill" id="lessonAccuracyStat">No accuracy data yet</div>
                    <div class="metric-pill" id="lessonTimeStat">No time tracked yet</div>
                </div>
                <p class="muted" id="lessonDetailStat">Complete a lesson to see details.</p>
            </div>
            <div class="dashboard-card voice-card">
                <h3>ğŸ™ï¸ Voice Settings</h3>
                <p class="muted">Select an EU Portuguese voice for lesson audio.</p>
                <div class="voice-settings">
                    <label class="select-label">Voice
                        <select id="voiceSelect" aria-label="Voice selection"></select>
                    </label>
                    <div class="voice-control-item">
                        <label>Speed: <span id="voiceSpeedValue">1.0x</span></label>
                        <div class="voice-speed-display">
                            <input type="range" id="voiceSpeedSlider" min="0.5" max="2" step="0.1" value="0.6">
                        </div>
                    </div>
                    <div class="voice-actions">
                        <button class="btn-small" id="voiceSampleBtn">â–¶ï¸ Test Voice</button>
                    </div>
                    <div class="voice-status" id="voiceStatus">Detecting voicesâ€¦</div>
                    
                    <!-- Download Section -->
                    <details class="voice-download-section" id="voiceDownloadSection">
                        <summary>ğŸ“¥ Download More Voices</summary>
                        <div class="voice-download-list" id="voiceDownloadList">
                            <p class="muted small">Loading downloadable voicesâ€¦</p>
                        </div>
                    </details>
                </div>
            </div>
        </div>
    </section>

    <section id="tips" class="tips-section">
        <div class="section-heading">
            <h2>EU Portuguese Tips (Free)</h2>
            <p class="muted">Proven ways to learn faster in 2025 without paying a cent.</p>
        </div>
        <div class="tips-grid">
            <div class="tip-card">
                <h3>Smart Note-Taking</h3>
                <ul>
                    <li>Use spaced, tiny cards: PT on top, EN + phonetics + example below.</li>
                    <li>Color-code gendered words (-o/-a) and nasal endings (Ã£o/Ãµe/em).</li>
                    <li>Record 10-second voice memos of your own pronunciation daily.</li>
                    <li>Weekly review: rewrite sentences from memory, then check audio.</li>
                </ul>
            </div>
            <div class="tip-card">
                <h3>Free Apps (Mobile + Desktop)</h3>
                <ul>
                    <li>Mobile: Google Recorder/Voice Memos + AnkiDroid/AnkiMobile for spaced repetition.</li>
                    <li>Desktop ("the C"): Anki + Language Reactor (YouTube/Netflix subtitles) + Mozilla TTS demo voices (EU-PT) for local playback.</li>
                    <li>Browser: Forvo + Lexico.pt for authentic EU-PT audio; Linguee for context sentences.</li>
                    <li>Keyboard: install PT-PT keyboard for fast accents (AltGr + vowels).</li>
                </ul>
            </div>
            <div class="tip-card">
                <h3>Daily Micro-Drills</h3>
                <ul>
                    <li>Shadow 5â€“8 key sentences (hear â†’ repeat) with nasal vowels and stress.</li>
                    <li>Swap gender/number: obrigadoâ†’obrigada, filhoâ†’filha, prontoâ†’pronta.</li>
                    <li>Record, compare to native audio, correct one sound per rep.</li>
                    <li>Finish with a 2-minute self-quiz: translate 5 words both directions.</li>
                </ul>
            </div>
            <div class="tip-card">
                <h3>Get Unstuck Fast</h3>
                <ul>
                    <li>Nasal vowels: hold the vowel shorter; focus on â€œÃ£o/Ã£e/Ãµeâ€ contrast.</li>
                    <li>Ser vs. Estar: ser = permanent traits; estar = states/locations.</li>
                    <li>Por vs. Para: por = through/cause; para = destination/purpose.</li>
                    <li>Listening wall: loop 30â€“60s of EU-PT radio daily to normalize rhythm.</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="plans" class="plans-section">
        <div class="section-heading">
            <h2>Learning Plans</h2>
            <p class="muted">Fast-track with free basics or unlock the paid hero path.</p>
        </div>
        <div class="plan-grid">
            <div class="plan-card">
                <div class="plan-header">
                    <span class="plan-label">Free Tier</span>
                    <span class="plan-duration">Weeks 0â€“4</span>
                </div>
                <ul class="plan-list">
                    <li>Week 1: Greetings, numbers 0â€“20, please/thank you; pronounce â€œÃ£o/Ã£esâ€.</li>
                    <li>Week 2: CafÃ© orders + transport; shadow 5 sentences daily.</li>
                    <li>Week 3: Daily routines (eu sou/estou/tenho); gender swaps for nouns.</li>
                    <li>Week 4: Survival phrases; 5-minute review sessions twice daily.</li>
                </ul>
                <div class="plan-outcome">Outcome: hold a 1â€“2 minute intro and order food confidently.</div>
            </div>
            <div class="plan-card premium-plan" id="paidPlan">
                <div class="plan-header">
                    <span class="plan-label premium">Paid Tier</span>
                    <span class="plan-duration">Weeks 5â€“24</span>
                </div>
                <div class="premium-locked" id="paidPlanLocked">
                    <p>Unlock Premium to see the full hero roadmap and practice packs.</p>
                    <button class="btn-premium" id="unlockPaidPlan">Go Premium</button>
                </div>
                <div class="premium-body" id="paidPlanBody">
                    <ul class="plan-list">
                        <li>Weeks 5â€“8: Pronunciation clean-up (Êƒ/Ê’, nasal vowels), 400-word core deck.</li>
                        <li>Weeks 9â€“12: Past & future tenses in speech; 3Ã— weekly speaking drills.</li>
                        <li>Weeks 13â€“18: Domain packs (travel, work, healthcare); role-play scripts.</li>
                        <li>Weeks 19â€“24: Fluency sprints; 10-minute conversation with <2 errors/min.</li>
                    </ul>
                    <div class="plan-outcome">Outcome: B1-B2 rangeâ€”handle travel, daily life, and basic work chats with clear EU-PT pronunciation.</div>
                    <div class="plan-metrics">Proficiency markers: 1000+ active words, narrate past/future, shadow native clips at 85â€“90% clarity.</div>
                </div>
            </div>
        </div>
    </section>

    <section id="coach" class="coach-section">
        <div class="section-heading">
            <h2>ğŸ“ AI Tutor (Free & Local)</h2>
            <p class="muted">Honest feedback from AIâ€”no false praise, truthful like a real teacher.</p>
        </div>
        
        <!-- AI Status Bar -->
        <div class="ai-status-bar">
            <div class="ai-status-item">
                <span class="status-label">Edge-TTS:</span>
                <span id="ttsStatus" class="status-dot status-checking">â—</span>
                <span id="ttsStatusText">Checking...</span>
            </div>
            <div class="ai-status-item">
                <span class="status-label">Whisper:</span>
                <span id="whisperStatus" class="status-dot status-checking">â—</span>
                <span id="whisperStatusText">Not loaded</span>
            </div>
            <div class="ai-status-item">
                <span class="status-label">Ollama:</span>
                <span id="ollamaStatus" class="status-dot status-checking">â—</span>
                <span id="ollamaStatusText">Checking...</span>
            </div>
        </div>

        <div class="coach-grid">
            <!-- Voice Selection Card -->
            <div class="coach-card">
                <h3>ğŸ¤ Voice Selection</h3>
                <p class="muted">Choose from 6 neural Portuguese voices</p>
                <div class="voice-selector">
                    <label for="aiVoiceSelect">Voice:</label>
                    <select id="aiVoiceSelect" class="voice-dropdown">
                        <option value="pt-PT-RaquelNeural">ğŸ‡µğŸ‡¹ Raquel (Portugal, Female)</option>
                        <option value="pt-PT-DuarteNeural">ğŸ‡µğŸ‡¹ Duarte (Portugal, Male)</option>
                        <option value="pt-BR-FranciscaNeural">ğŸ‡§ğŸ‡· Francisca (Brazil, Female)</option>
                        <option value="pt-BR-AntonioNeural">ğŸ‡§ğŸ‡· AntÃ³nio (Brazil, Male)</option>
                        <option value="pt-BR-ThalitaMultilingualNeural">ğŸ‡§ğŸ‡· Thalita (Brazil, Multilingual)</option>
                        <option value="pt-BR-MacerioMultilingualNeural">ğŸ‡§ğŸ‡· MacÃ©rio (Brazil, Multilingual)</option>
                    </select>
                </div>
                <div class="voice-test">
                    <button id="testVoiceBtn" class="btn btn-small">ğŸ”Š Test Voice</button>
                    <span id="voiceTestStatus" class="muted"></span>
                </div>
            </div>

            <!-- Pronunciation Practice Card -->
            <div class="coach-card">
                <h3>ğŸ¯ Pronunciation Practice</h3>
                <p class="muted">Record yourself and get honest AI feedback</p>
                <div class="pronunciation-input">
                    <label for="practicePhrase">Phrase to practice:</label>
                    <input type="text" id="practicePhrase" placeholder="Bom dia, como estÃ¡?" class="practice-input">
                    <button id="hearPhraseBtn" class="btn btn-small">ğŸ”Š Hear</button>
                </div>
                <div class="recording-controls">
                    <button id="recordBtn" class="btn btn-record" disabled>ğŸ™ï¸ Record</button>
                    <button id="loadWhisperBtn" class="btn btn-small">ğŸ“¥ Load Whisper</button>
                    <span id="recordingStatus" class="muted">Load Whisper to enable recording</span>
                </div>
                <div id="transcriptionResult" class="transcription-result" style="display:none;">
                    <strong>You said:</strong> <span id="transcribedText"></span>
                </div>
            </div>

            <!-- AI Feedback Card -->
            <div class="coach-card coach-card-wide">
                <h3>ğŸ“ Honest AI Feedback</h3>
                <p class="muted">Truthful evaluationâ€”mistakes will be clearly identified</p>
                <div id="aiFeedback" class="ai-feedback">
                    <p class="muted">Practice a phrase to receive honest feedback.</p>
                </div>
                <div id="pronunciationScore" class="pronunciation-score" style="display:none;">
                    <div class="score-bar">
                        <div id="scoreBarFill" class="score-bar-fill"></div>
                    </div>
                    <span id="scoreText" class="score-text"></span>
                </div>
            </div>

            <!-- Skill Dashboard Card -->
            <div class="coach-card">
                <h3>ğŸ“Š Skill Dashboard</h3>
                <div id="skillStats" class="skill-grid">
                    <p class="muted">Complete a lesson to see skill stats.</p>
                </div>
                <div class="fix-pack-list" id="fixPackList">
                    <p class="muted">No fix packs yetâ€”make a few attempts first.</p>
                </div>
            </div>

            <!-- Tips Card -->
            <div class="coach-card">
                <h3>ğŸ’¡ Smart Tips</h3>
                <div id="aiHints" class="hint-list">
                    <p class="muted">Complete a lesson or quiz to see personalized tips.</p>
                </div>
                <h4>Common Challenges:</h4>
                <ul id="stuckList" class="stuck-list">
                    <li>Nasal sounds: practice "pÃ£o / mÃ£os / coraÃ§Ãµes" slowly.</li>
                    <li>Gender endings: swap -o/-a pairs and listen twice.</li>
                    <li>Sentence melody: shadow native speakers for stress patterns.</li>
                </ul>
            </div>
        </div>
    </section>
    </div>
    </main>

    <!-- Bottom Navigation Bar -->
    <nav class="bottom-nav" id="bottomNav">
        <button class="nav-tab active" data-page="home">
            <span class="nav-icon">ğŸ </span>
            <span class="nav-label">Home</span>
        </button>
        <button class="nav-tab" data-page="learn">
            <span class="nav-icon">ğŸ“š</span>
            <span class="nav-label">Learn</span>
        </button>
        <button class="nav-tab" data-page="practice">
            <span class="nav-icon">ğŸ¯</span>
            <span class="nav-label">Practice</span>
        </button>
        <button class="nav-tab" data-page="profile">
            <span class="nav-icon">ğŸ‘¤</span>
            <span class="nav-label">Profile</span>
        </button>
    </nav>

    <!-- Dialogues Modal (fullscreen overlay) -->
    <div id="dialoguesModal" class="fullscreen-modal" style="display:none;">
        <div class="modal-header">
            <button class="btn-back" id="dialoguesBackBtn">â† Back</button>
            <h2>ğŸ’¬ Real-World Dialogues</h2>
        </div>
        <div id="dialoguesList" class="dialogues-grid">
            <!-- Dialogues will be rendered here -->
        </div>
        <div id="dialoguePlayer" class="dialogue-player" style="display:none;">
            <div class="dialogue-header">
                <h3 id="dialogueTitle"></h3>
                <button class="btn-close" id="closeDialogueBtn">âœ•</button>
            </div>
            <div id="dialogueContent" class="dialogue-content"></div>
            <div id="dialogueChoices" class="dialogue-choices"></div>
            <div class="dialogue-controls">
                <button class="btn-secondary" id="dialogueRestartBtn">ğŸ”„ Restart</button>
                <button class="btn-secondary" id="dialogueHintBtn">ğŸ’¡ Hint</button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal" style="display:none;">
        <div class="modal-content login-modal">
            <span class="close-modal" id="closeLogin">&times;</span>
            <h2>ğŸ‘¤ Sign In</h2>
            <p class="muted">Use your name to save progress. Admins can add a password for unlimited hearts.</p>
            <div class="login-form">
                <input type="text" id="usernameInput" placeholder="Name or nickname" class="login-input">
                <input type="password" id="adminPassword" placeholder="Admin password (optional)" class="login-input">
                <div class="login-actions">
                    <button class="btn-login" id="loginBtn">Login</button>
                    <button class="btn-secondary" id="guestBtn" type="button">Continue as Guest</button>
                </div>
            </div>
            <p id="loginError" class="error-text" style="display:none;"></p>
        </div>
    </div>

    <!-- Out of Hearts Modal -->
    <div id="heartsModal" class="modal" style="display:none;">
        <div class="modal-content hearts-modal">
            <span class="close-modal" id="closeHearts">&times;</span>
            <div class="hearts-empty">
                <span class="big-heart">ğŸ’”</span>
                <h2>Out of Hearts!</h2>
                <p class="muted">You've run out of hearts. Wait for them to refill or go premium!</p>
                <div class="refill-timer">
                    <span>â¤ï¸ Next heart in: </span>
                    <span id="refillCountdown">30:00</span>
                </div>
            </div>
            <div class="hearts-actions">
                <button class="btn-premium" id="getPremiumBtn">ğŸ‘‘ Go Premium - Unlimited Hearts</button>
                <button class="btn-secondary" id="waitBtn">I'll wait</button>
            </div>
        </div>
    </div>

    <div id="analyticsModal" class="modal" style="display:none;">
        <div class="modal-content large-modal">
            <span class="close-modal" id="closeAnalytics">&times;</span>
            <h2>ğŸ“Š Progress Analytics</h2>
            <div class="analytics-grid">
                <div class="chart-card">
                    <h3>Retention Curve</h3>
                    <canvas id="retentionChart" width="400" height="200"></canvas>
                    <p class="muted">Your word retention over time</p>
                </div>
                <div class="chart-card">
                    <h3>Forgetting Curve</h3>
                    <canvas id="forgettingChart" width="400" height="200"></canvas>
                    <p class="muted">Words due for review</p>
                </div>
                <div class="stats-card">
                    <h3>Study Statistics</h3>
                    <div id="studyStats"></div>
                </div>
                <div class="stats-card">
                    <h3>Weak Words</h3>
                    <div id="weakWords"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="paywall" class="paywall-modal" style="display: none;">
        <div class="paywall-content">
            <span class="close-paywall">&times;</span>
            <h2>ğŸŒŸ Unlock Premium Features</h2>
            <div class="premium-features">
                <div class="feature">âœ“ Unlimited AI Conversations</div>
                <div class="feature">âœ“ Advanced Pronunciation Feedback</div>
                <div class="feature">âœ“ Intermediate & Advanced Lessons</div>
                <div class="feature">âœ“ Offline Access</div>
                <div class="feature">âœ“ Certificate of Completion</div>
            </div>
            <button class="btn-subscribe">Subscribe Now - $9.99/month</button>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <span class="version-pill" id="appVersion">v0.9.0</span>
            <span>PortuLingo - Learn European Portuguese</span>
        </div>
    </footer>

    <!-- Core Modules -->
    <script type="module" src="./auth.js"></script>
    <script type="module" src="./ai-tts.js"></script>
    <script type="module" src="./ai-speech.js"></script>
    <script type="module" src="./ai-tutor.js"></script>
    <script type="module" src="./app.js"></script>
    <!-- AI Chat Widget -->
    <script type="module" src="./ai-chat.js"></script>
</body>
</html>
